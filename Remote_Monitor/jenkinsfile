pipeline {
    agent any

    environment {
                SSH_KEY = '/var/jenkins_home/.ssh/id_rsa'
                REMOTE_USER = 'jenkinsusr'
                REMOTE_HOST = '192.168.50.125'
                //WEB_SERVICE = 'motivation'
                //WEB_TEST = "Your problem"
                
            }

    stages {

        stage('Copy & Script') {
            steps {
                sh '''
                    scp -i $SSH_KEY Remote_Monitor/performance_checker.sh $REMOTE_USER@$REMOTE_HOST:/tmp/InstallWebService.sh             
                    ssh -i $SSH_KEY $REMOTE_USER@$REMOTE_HOST <<'EOF'
                    chmod +x /tmp/InstallWebService.sh
                    /tmp/InstallWebService.sh
                '''
            }

        }

         stage('Copy Reports') {
            steps {
                sh '''
                    scp $REMOTE_USER@192.168.50.125:/tmp/*performance.log Remote_Monitor/
                    scp -i $SSH_KEY Remote_Monitor/performance_checker.sh $REMOTE_USER@$192.168.50.120:/loger
                '''
            }

        

        }

    }
}
